<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>ComfortCafe Portal: The Eye Awakens</title>
  <style>
    html, body {
      margin: 0;
      height: 100%;
      overflow: hidden;
      background: radial-gradient(circle at center, #050510 0%, #02010a 40%, #000 100%);
      font-family: 'Courier New', monospace;
      color: #9ffcff;
      text-align: center;
    }

    /* Eye container */
    #eye-container {
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      animation: slowRotate 40s linear infinite;
    }

    #eye-container img {
      width: 320px;
      height: 320px;
      border-radius: 50%;
      box-shadow: 0 0 25px 5px rgba(0, 200, 255, 0.4),
                  0 0 60px 20px rgba(140, 0, 255, 0.15);
      transition: transform 3s ease, box-shadow 3s ease;
      cursor: pointer;
    }

    #readyText {
      position: absolute;
      top: 65%;
      left: 50%;
      transform: translateX(-50%);
      font-size: 1.8em;
      color: #9ffcff;
      text-shadow: 0 0 10px #4bfaff, 0 0 25px #a45bff;
      opacity: 0;
      transition: opacity 2s ease;
    }

    /* Sway animation for dreamy quake */
    @keyframes slowRotate {
      from { transform: translate(-50%, -50%) rotate(0deg); }
      to { transform: translate(-50%, -50%) rotate(360deg); }
    }

    @keyframes sway {
      0%, 100% { transform: rotate(0deg); }
      25% { transform: rotate(0.6deg); }
      50% { transform: rotate(-0.6deg); }
      75% { transform: rotate(0.4deg); }
    }

    /* Terminal scene */
    #terminal {
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0, 0, 20, 0.9);
      color: #9ffcff;
      display: none;
      padding: 40px;
      text-align: left;
      overflow-y: auto;
      box-sizing: border-box;
      animation: fadeIn 3s ease forwards;
    }

    @keyframes fadeIn {
      from { opacity: 0; }
      to { opacity: 1; }
    }

    #terminalText {
      white-space: pre-wrap;
      font-size: 1rem;
      line-height: 1.5;
      opacity: 0;
      animation: typeText 5s steps(80, end) forwards;
    }

    @keyframes typeText {
      from { opacity: 0; }
      to { opacity: 1; }
    }
  </style>
</head>
<body>
  <audio id="bg-audio" src="cafespiritpulse.mp3" loop></audio>

  <div id="eye-container">
    <img id="eyeImage" src="loadingeye.jpeg" alt="Ezekiel Eye" />
  </div>
  <div id="readyText">Ready to Rock?</div>

  <div id="terminal">
    <div id="terminalText"></div>
  </div>

  <script>
    const eye = document.getElementById('eyeImage');
    const readyText = document.getElementById('readyText');
    const audio = document.getElementById('bg-audio');
    const terminal = document.getElementById('terminal');
    const terminalText = document.getElementById('terminalText');
    const eyeContainer = document.getElementById('eye-container');

    let clickedOnce = false;
    let clickedTwice = false;

    eye.addEventListener('click', async () => {
      if (!clickedOnce) {
        // First click: stop rotation, fade in text, start ambient audio
        clickedOnce = true;
        eyeContainer.style.animationPlayState = 'paused';
        readyText.style.opacity = 1;

        try {
          await audio.play();
          audio.volume = 0;
          let fadeIn = setInterval(() => {
            if (audio.volume < 0.5) audio.volume += 0.01;
            else clearInterval(fadeIn);
          }, 100);
        } catch (err) {
          console.warn('Autoplay restriction, audio will start on next click.');
        }
      } else if (!clickedTwice) {
        // Second click: sway, fade out audio, then show terminal
        clickedTwice = true;
        document.body.style.animation = 'sway 6s ease-in-out infinite';
        readyText.style.opacity = 0;

        // Fade out audio
        let fadeOut = setInterval(() => {
          if (audio.volume > 0.02) audio.volume -= 0.02;
          else {
            clearInterval(fadeOut);
            audio.pause();
          }
        }, 100);

        setTimeout(() => {
          // Stop sway, reveal terminal
          document.body.style.animation = '';
          terminal.style.display = 'block';
          loadTerminalScene();
        }, 6000);
      }
    });

    function loadTerminalScene() {
      const introText = `
> CONNECTION ESTABLISHED... ☕
> Welcome to the ComfortCafe Network.
> The threads between realms have awakened.
> Choose your connection path:

   [1] STAR — The Violet Strategist
   [2] MILO — The Mint Poet
   [3] MIKI — The Yellow Spike
   [4] CHARI — The Lavender Dreamer

> Awaiting input...`;
      terminalText.textContent = introText;
      terminalText.style.opacity = 1;
    }
  </script>
</body>
</html>
